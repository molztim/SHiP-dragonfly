from machine import Pin, I2C
import utime
from mpu6050 import *
import math
 
i2c = I2C(0, scl=Pin(21), sda=Pin(20), freq=400000)
init_mpu6050(i2c)

angle_data = [0.3706221, 0.185575, 0.1570169, 0.4601264, 0.28599, 0.2238116, 0.2074787, 0.3946571, 0.4338615, 0.2517881, 0.2940857, 0.2027085, 0.4252059, 0.1938267, 0.3911709, 0.2229355, 0.5485828, 0.4361108, 0.3896676, 0.3663745, 0.2616959, 0.5282308, 0.28599, 0.1666884, 0.2084198, 0.3516589, 0.4111689, 0.1119054, 0.4087826, 0.3722028, 0.1493532, 0.4015383, 0.03426364, 0.6065176, 0.2148912, 0.1370559, 0.04845634, 0.2074787, 0.2373883, 0.3195937, 0.6824232, 0.3006656, 0.2533377, 0.2873554, 0.1619252, 0.104678, 0.4144866, 0.3146572, 0.3152787, 0.4545645, 0.2954131, 0.1655108, 0.4445538, 0.08392872, 0.1582582, 0.3538779, 0.181308, 0.4685546, 0.1493532, 0.2719624, 0.271242, 0.2646698, 0.1398818, 0.3784591, 0.195835, 0.1570169, 0.2211733, 0.228997, 0.2017412, 0.02797603, 0.3505443, 0.2676106, 0.3045455, 0.364232, 0.1101428, 0.3232464, 0.4015383, 0.2556444, 0.4562831, 0.2733977, 0.15949, 0.3588195, 0.08392872, 0.3758649, 0.05595248, 0.2502291, 0.07661636, 0.2373883, 0.2741121, 0.346615, 0.3102739, 1.036654, 0.1506575, 0.2167046, 0.3195937, 1.289375, 0.1845174, 0.3566315, 0.1631292, 0.2102894]
#data = [0.9870226, 0.9837541, 0.9825175, 0.9839545, 0.987689, 0.9786715, 0.9794308, 0.9819963, 0.9818032, 0.9857563, 0.9856378, 0.981218, 0.9819198, 0.9836066, 0.9835909, 0.9802567, 0.9866639, 0.9811923, 0.9829045, 0.9787737, 0.9788435, 0.9893635, 0.9783972, 0.984559, 0.9847165, 0.9836401, 0.9823591, 0.9778628, 0.984072, 0.9788344, 0.9828918, 0.9812979, 0.973791, 0.9861394, 0.974743, 0.9789164, 0.9807084, 0.9803136, 0.9839963, 0.9711758, 0.9810341, 0.9711845, 0.9785091, 0.9878376, 0.9872596, 0.9819776, 0.979456, 0.9823855, 0.9969752, 0.986576, 0.9833944, 0.9886139, 0.9828633, 0.9854798, 0.980621, 0.9899141, 0.9856535, 0.9787801, 0.9875929, 0.9865848, 0.9851719, 0.9784141, 0.9831233, 0.9837447, 0.9826189, 0.9871712, 0.9801462, 0.981671, 0.9801815, 0.9762363, 0.9764223, 0.9814348, 0.9806812, 0.9822284, 0.9841237, 0.983581, 0.9830046, 0.9835857, 0.986244, 0.9755696, 0.9787521, 0.9857777, 0.9890257, 0.982069, 0.9878859, 0.9762243, 0.9858339, 0.986442, 0.9811914, 0.9817753, 0.9813159, 0.9784628, 0.9794306, 0.9838063, 0.9839507, 0.9815861, 0.9834242, 0.9894124, 0.9759904, 0.9863957]
#100 Test data in X
#data = [-0.9812012, -0.9770508, -0.9836426, -0.9807129, -0.9731445, -0.9782715, -0.9873047, -0.9868164, -0.9807129, -0.9838867, -0.980957, -0.9794922, -0.9836426, -0.984375, -0.9863281, -0.9821777, -0.9787598, -0.9831543, -0.9863281, -0.9829102, -0.9802246, -0.9790039, -0.9868164, -0.9853516, -0.9816895, -0.9799805, -0.9851074, -0.9804688, -0.9836426, -0.984375, -0.9819336, -0.9853516, -0.9802246, -0.9802246, -0.9885254, -0.9821777, -0.9812012, -0.9804688, -0.9829102, -0.9882813, -0.9692383, -0.9799805, -0.9833984, -0.9848633, -0.9775391, -0.9851074, -0.9853516, -0.9802246, -0.9934082, -0.9797363, -0.9836426, -0.9787598, -0.9797363, -0.9797363, -0.9838867, -0.9841309, -0.9870605, -0.9819336, -0.9802246, -0.9846191, -0.9816895, -0.9814453, -0.9853516, -0.9807129, -0.9790039, -0.9973145, -0.9829102, -0.9804688, -0.9768066, -0.9775391, -0.9697266, -0.9799805, -0.982666, -0.9748535, -0.9709473, -0.9782715, -0.9816895, -0.979248, -0.9807129, -0.9841309, -0.9838867, -0.9780273, -0.9814453, -0.9887695, -0.9763184, -0.9841309, -0.982666, -0.9743652, -0.9777832, -0.9824219, -0.9873047, -0.9848633, -0.9853516, -0.9885254, -0.9821777, -0.9887695, -0.9807129, -0.9787598, -0.9816895, -0.986084]
angle_difference = [0.2007689, 0.4813262, 0.5524925, 0.1769384, 0.4849711, 0.2900664, 0.4073439, 0.1570169, 0.4423473, 0.5374119, 0.969144, 0.9002687, 0.4387944, 0.5574286, 0.684713, 1.044364, 0.3604517, 0.172458, 0.5341249, 0.9807848, 0.8072133, 0.9491508, 0.2564083, 0.4173096, 0.2748252, 0.3815484, 0.2229355, 0.3763852, 0.4252059, 0.260947, 0.2055842, 0.4049348, 0.623068, 0.2017412, 0.1356207, 0.4427895, 0.3647686, 0.1643241, 0.1666884, 0.2947504, 0.07912902, 0.4265843, 0.3966353, 1.21997, 1.161296, 0.568895, 0.6728944, 0.8067282, 0.9232328, 1.281916, 1.165668, 0.2639294, 0.2365625, 0.1384761, 0.4073439, 0.4228986, 0.635814, 0.3134111, 0.7063754, 0.61453, 0.6081286, 0.288714, 0.5888385, 0.5315541, 0.4833546, 0.7551105, 0.2940857, 0.4768334, 0.1453695, 0.451541, 0.195835, 0.3189807, 0.2811603, 0.1519506, 0.3566315, 0.2900664, 0.7214503, 0.5828266, 0.3636941, 0.2315462, 0.4201134, 0.7815958, 0.5637119, 0.5791215, 0.4405745, 0.108352, 0.07401833, 0.7850931, 0.7937688, 0.260947, 0.6570035, 0.6510197, 0.1802256, 0.4601264, 0.3626167, 0.2281411, 0.2676106, 0.8607102, 0.773796, 0.1027918]

xdata = []
ydata = []
zdata = []
for i in range(100):
    data = get_mpu6050_data(i2c)
    xdata.append(data['accel']['x'])
    ydata.append(data['accel']['y'])
    zdata.append(data['accel']['z'])

def stat(data):
    print("New:")
    n = 100
    mu = sum(data)/len(data)
    print(f"Mu {mu}")
    sig = 0
    for xi in data:
        sig += (xi - mu)**2
    sig = sig/(len(data)-1)
    print("Sig {:.7f}".format(sig))
    musig = sig / math.sqrt(len(data))
    print(f"Musig {musig}\n")
    
print("X")
stat(xdata)
print("Y")
stat(ydata)
print("Z")
stat(zdata)
print("ANGLE")
stat(angle_data)
print("Angle diff.")
stat(angle_difference)
